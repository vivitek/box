version: "2"

services:
  # dhcp:
  #   build: ./dhcp
  #   network_mode: "host"
  #   privileged: true
  #   expose:
  #     - 67
  #     - 68
  #   depends_on:
  #     - rabbitmq
  # rabbitmq:
  #   image: rabbitmq:3.7-management
  #   restart: "always"
  #   environment:
  #     RABBITMQ_ERLANG_COOKIE: "secret"
  #     RABBITMQ_DEFAULT_USER: vivi
  #     RABBITMQ_DEFAULT_PASS: vivitek
  #   ports:
  #     - 5672:5672
  #     - 15672:15672
  # pcap:
  #   build: ./pcap
  #   privileged: true
  #   network_mode: "host"
  #   depends_on:
  #     - rabbitmq
  postgres:
    image: postgres
    environment:
      - POSTGRES_USER=rbouvard
      - POSTGRES_PASSWORD=postgrespwd
      - DATABASE_URL=postgresql://rbouvard:postgrespwd@localhost:5432/firewallDB
    ports:
      - "5432:5432"
  firewall:
    build: ./firewall
    privileged: true
    environment:
      - DATABASE_URL=postgresql://rbouvard:postgrespwd@localhost:5432/firewallDB # idk guys
    depends_on:
      - postgres
    ports:
      - "5000:5000"
    labels:
        io.balena.features.kernel-modules: '1'
