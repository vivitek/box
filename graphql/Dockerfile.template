FROM balenalib/%%BALENA_MACHINE_NAME%%-node

COPY package.json .
RUN npm install
RUN npm install typescript -g

ENV VINCIPIT_DEVICE_ID="609d63a7cc5e70819887fbd6"
ENV VINCIPIT_BEARER_TOKEN="Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MDNmNTlhNjlhZDY1MjEzZGRkYzM2ODEiLCJlbWFpbCI6ImpvaG4uZG9lQHZpbmNpcGl0LmNvbSIsInBhc3N3b3JkIjoiJDJiJDEyJEdYclYvSmF4M0ZQNHJaNE13YUhoV2U3dkNOcC9PcXRHMlRnd1VsZC5DMGQ2Z2ZSLzJ3N1ppIiwidXNlcm5hbWUiOiJ1c2VyIiwiX192IjowLCJpYXQiOjE2MTQ3NjQ0NjV9.n49X78hDvX6eyrdhtNHcDTR2ds8rLWWtKkgDsHgQq6s"
ENV AMQP_HOSTNAME="0.0.0.0"
ENV AMQP_USERNAME="vivi"
ENV AMQP_PASSWORD="vivitek"

COPY . .
RUN tsc
CMD ["node", "dist/src/index.js"]
